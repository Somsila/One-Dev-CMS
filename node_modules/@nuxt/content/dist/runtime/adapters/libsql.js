import { createClient } from "@libsql/client/web";
import { createDatabaseAdapter } from "../internal/database-adapter.js";
let client;
export default createDatabaseAdapter((opts) => {
  if (!client) {
    client = createClient({
      url: opts.url,
      authToken: opts.authToken
    });
  }
  return {
    async all(sql, params) {
      const res = await client.execute({ sql, args: params || [] });
      return res.rows;
    },
    async first(sql, params) {
      const res = await client.execute({ sql, args: params || [] });
      return res.rows[0];
    },
    async exec(sql) {
      await client.execute(sql);
    }
  };
});
