import { refineContentFields } from "./collection.js";
export function createDatabaseAdapter(factory) {
  return (opts) => {
    const adapter = factory(opts);
    return {
      all: async (sql, params) => {
        const result = await adapter.all(sql, params);
        if (!result) {
          return [];
        }
        return result.map((item) => refineContentFields(sql, item));
      },
      first: async (sql, params) => {
        const item = await adapter.first(sql, params);
        if (!item) {
          return item;
        }
        return refineContentFields(sql, item);
      },
      exec: async (sql) => {
        return adapter.exec(sql);
      }
    };
  };
}
